<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title id="title">Nativetojs</title>
    <script type="text/javascript">
        var success = -1;
		var inAppPurchaseData = ""

		function callandroid(){
                console.log("liangjunming showFloatWindow ");
                var params = {"appid":"101541297"}
				HwFastappObject.showFloatWindow(JSON.stringify(params));
        }
            function callandroid1(){
                console.log("liangjunming hideFloatWindow ");
				var params = {"appid":"101541297"}
                HwFastappObject.hideFloatWindow(JSON.stringify(params));
            }
            function GamesignIn(){
		    var params = {"appid":"101541297","forceLogin":1}
	        HwFastappObject.gameLogin(JSON.stringify(params));
	        }

	        HwFastappObject.onGameLoginResult = function onGameLoginResult(str){
		        if (str.code == 0) {
		             success = 0;
		             callandroid();
		        }
	        }
			
			function getProductDetails (){
		    var params = {
			    "merchantId": "890086000000001051",
                "applicationID": "101541297",
                "requestId": "123",
                "productNos": "d01|d02",}
	        HwFastappObject.getProductDetails(JSON.stringify(params));
	        }

	        HwFastappObject.onGetProductDetailsResult  = function onGetProductDetailsResult (str){
			    alert("查询结果:sign:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
				system.postMessage("web call quickapp");
			    console.log("yuli","onGetProductDetailsResult ="+JSON.stringify(str));
		        
	        }
			
			function productPay (){
			var params = {"merchantId": "890086000000001051",
                "applicationID": "101541297",
                "requestId": "20201114025803669",
                "productNo": "d01",
                "serviceCatalog":"1",
                "merchantName":"d01",
                "sdkChannel":1,
                "publicKey": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtTOTA354idE76xHbVdEMUwDaOc6UFc6l2Mz+RAbNBtdpkLWc2VJGSDLEAKjRpk5D4v2ZIZrTB1PMfiWQYIWcHMiUrKn2Eak55IyaQzg1jbBfxKE5Q4czdRUqt/2Djvyk7+nZCicQf++G1thPwLamFcgFP2dXY3R4koSRb0dyfjomnp5rJ+gZsOnLQxItoNrKpbvvVLSl73QIlzaqEv3HO5s6WPj2Zv+cP9JN2fQY6psKey7Tpys1i2N9x0BnXCviTahOvMtzV1b/5hVYKiw34l/ZugQhTpGvjFemjZQ2jkY8MgJYlqc4e17aCr2JyT2c600FB0mPXKmOf8fSLAKl9wIDAQAB",
                "sign": "B+kDxQO+fcJQ6/auP13SKhr7Zr+lhyMe2qtXRs21b6nBFPfUqUQjvYvNhVAZeeNSsH1TqdBCV2+9U7ZMxPR9AEs/96sNouqCm2mUMEl36vSd6h9Y9mFkNgqeV3gdjihHEZowuA0+l9rYBUtYaF1zNwmsmXXRQqwoBgy/yMr7NAzpS/Zbx1uqFx7OzxWb8ySU+JWle+btWwPony35fKwFpLJ7l5VkqvgYQdsgcAUhjoeQ20KhUmFPjM2b/Qjn/SdIQTInTLrvLn8+ycs6MmrR00iw9NEhKGRFnC2CmV/9mm7F+J78yElK76Cxgp17pk4y9NjC1ZRhdAwz5VKZuVNG8w==",
				}
	        HwFastappObject.productPay(JSON.stringify(params));
	        }

	        HwFastappObject.onProductPayResult  = function onProductPayResult (str){
			    alert("支付结果:sign:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
				system.postMessage("web call quickapp");
			    console.log("yuli","productPay ="+JSON.stringify(str));
		        
	        }
			
			
			
			function pay (){
			var params = {
                "amount": 0.01,     //商品金额
				"applicationID": "101541297",    //应用ID，在华为开发者联盟上获取的APP ID 
				"productDesc": "d03",
				"productName": "d03",
				"serviceCatalog": "X5",    //游戏设置为"X6"，应用设置为"X5" 
				"merchantId": "890086000000001051",    //华为开发者联盟上申请支付服务获取的“支付ID“
				"merchantName": "d03",    //商户名称
				"sign": "G+2TQxtDCl/OSVfXCxR165PZj7Tm1VOL3dl8UgKSlV6et5YSf+PDf3vqgrDwVIzqijC49OSd6I9DPxFZE8jBd6Rq3d6rwFDcgW6Z3OmXh54Q+UohrpqkTEXX7NPlxrfIQIOYnE67SU84c+vNrDQwtMCbLB58gYLpXUrFBnZBsVFy1xhPzQvYA2sjvaD+WwvKUAl/8NVq0oN6ux84dS60+ItUDS6EjIJGFEZO3iCHpkC3DZdY0GiLGO+rb7fgfqxyM4cEiqZ4wVxtkJcpdEJ6mLCFvSktEcQVjNzdVTuQzUYvQ0Gt3sxVxW/p3L/vJvx60rmwH1neU4M3ZqDXs1+nDg==",    //签名
				"requestId": "20201111041031686",    //在支付前生成，用于唯一标识一次支付请求。支付平台在服务器回调接口中会原样返回requestId的值 
				"urlver": "2",    //固定值为2
				"sdkChannel": 1,    //游戏设置为3，应用设置为1
				"publicKey": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtTOTA354idE76xHbVdEMUwDaOc6UFc6l2Mz+RAbNBtdpkLWc2VJGSDLEAKjRpk5D4v2ZIZrTB1PMfiWQYIWcHMiUrKn2Eak55IyaQzg1jbBfxKE5Q4czdRUqt/2Djvyk7+nZCicQf++G1thPwLamFcgFP2dXY3R4koSRb0dyfjomnp5rJ+gZsOnLQxItoNrKpbvvVLSl73QIlzaqEv3HO5s6WPj2Zv+cP9JN2fQY6psKey7Tpys1i2N9x0BnXCviTahOvMtzV1b/5hVYKiw34l/ZugQhTpGvjFemjZQ2jkY8MgJYlqc4e17aCr2JyT2c600FB0mPXKmOf8fSLAKl9wIDAQAB"    //华为开发者联盟上申请支付服务获取的“支付公钥”
				
				}				
				alert("pay:"+JSON.stringify(params));
	        HwFastappObject.pay(JSON.stringify(params));
	        }
			
	        HwFastappObject.onPayResult  = function onPayResult (str){
			    alert("支付结果:sign:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
				system.postMessage("web call quickapp");
			    console.log("yuli","pay ="+JSON.stringify(str));
		        
	        }
			
			
			function getPurchaseInfo (){
			    var params = {"merchantId": "890086000000001051",
                "appId": "101541297",
                "requestId": "20191130093403165",
                "priceType": 3,
                //"productId":"yuFan",
                "pageNo":1,
                "ts": 1575078212039,
                "publicKey": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtTOTA354idE76xHbVdEMUwDaOc6UFc6l2Mz+RAbNBtdpkLWc2VJGSDLEAKjRpk5D4v2ZIZrTB1PMfiWQYIWcHMiUrKn2Eak55IyaQzg1jbBfxKE5Q4czdRUqt/2Djvyk7+nZCicQf++G1thPwLamFcgFP2dXY3R4koSRb0dyfjomnp5rJ+gZsOnLQxItoNrKpbvvVLSl73QIlzaqEv3HO5s6WPj2Zv+cP9JN2fQY6psKey7Tpys1i2N9x0BnXCviTahOvMtzV1b/5hVYKiw34l/ZugQhTpGvjFemjZQ2jkY8MgJYlqc4e17aCr2JyT2c600FB0mPXKmOf8fSLAKl9wIDAQAB",
                "sign": "Zb8fTUM7DYfHVxTZCs6sR3rOXIV9dGDjaofk3I5Db3Mk3E6PfuMWw3ZEs3+C/V98BhO0mRwVBKFscpOVKfsMMQ=="//签名,
				}
	            HwFastappObject.getPurchaseInfo(JSON.stringify(params));
	        }

	        HwFastappObject.onGetPurchaseInfoResult  = function onGetPurchaseInfoResult (str){
			    alert("查询结果:sign:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onGetPurchaseInfoResult ="+JSON.stringify(str));
		        
	        }
			function getOrderDetail (){
			    var params = {
				"merchantId": "890086000000001051",
                "keyType": 1,
                "time":"1575077540497",
                "requestId":"20191130090220741",
                "publicKey": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtTOTA354idE76xHbVdEMUwDaOc6UFc6l2Mz+RAbNBtdpkLWc2VJGSDLEAKjRpk5D4v2ZIZrTB1PMfiWQYIWcHMiUrKn2Eak55IyaQzg1jbBfxKE5Q4czdRUqt/2Djvyk7+nZCicQf++G1thPwLamFcgFP2dXY3R4koSRb0dyfjomnp5rJ+gZsOnLQxItoNrKpbvvVLSl73QIlzaqEv3HO5s6WPj2Zv+cP9JN2fQY6psKey7Tpys1i2N9x0BnXCviTahOvMtzV1b/5hVYKiw34l/ZugQhTpGvjFemjZQ2jkY8MgJYlqc4e17aCr2JyT2c600FB0mPXKmOf8fSLAKl9wIDAQAB",
                "sign": "LYfiazkOTM1KCACJFy7pbzXdKaNdb+ChQZQ8YADpUmMrnQToRT9QvNR9JgilBn5TsG683hTqBBw0ksVVmL1/AQ==",}
				HwFastappObject.getOrderDetail(JSON.stringify(params));
	        }

	        HwFastappObject.onGetOrderDetailResult  = function onGetOrderDetailResult (str){
			    alert("查询结果:sign:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onGetOrderDetailResult ="+JSON.stringify(str));
		        
	        }
			
			function isEnvReady (){
			    var params = {isEnvReadyReq: {"applicationID": "101541297"}}
				HwFastappObject.isEnvReady(JSON.stringify(params));
	        }

	        HwFastappObject.onIsEnvReadyResult  = function onIsEnvReadyResult (str){
			    alert("onIsEnvReadyResult:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onIsEnvReadyResult ="+JSON.stringify(str));
		        
	        }
			
			function isSandboxActivated (){
			    var params = {isSandboxActivatedReq: {"applicationID": "101541297",}}
				HwFastappObject.isSandboxActivated(JSON.stringify(params));
	        }

	        HwFastappObject.onIsSandboxActivatedResult  = function onIsSandboxActivatedResult (str){
			    alert("onIsSandboxActivatedResult:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onIsSandboxActivatedResult ="+JSON.stringify(str));
	        }
			
			function obtainOwnedPurchases (){
			var priceType = document.getElementById("priceType")
			    var params = { ownedPurchasesReq: {"priceType": priceType.value,"applicationID": "101541297",
				"publicKey":"MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAnLLFO6c8d1x6jdbZ8PkNtrLtRMiFaRqWZgEjC4Vj9QXnPCmDZoPO5A5TSwzlWjYL5ktbbDnZC6Vfp8VI8nTMm8DvbGsJ+1ihru31vG1gqvUgOaXESqBhdpMrKFEgNBV8zlalLpcCU6Gayd8QJCxXRPcUisHLTQFJHjTMOWmvOcKiSxt1VmG3dvfWVkoMeKyerZy4qHEWM/asJihPZATBQ7puMC/kOh6i8V2gv4w/74KWifpBr3J5RN+PK6E7yWUqIALFTnN5vOIif2HELvgt+S6uaGpRydhSwu1xtV7bPtXQY20ollYo4BUi+AvM16iBCa1+1Mdw0y6Y9gZAtpHRK1Pf+yea4aoY4y/bZ6EX21wucvbzxexDcBkGn0DVvNHKr3usmUmq/yfMMmDPqPujv3iDWKFENfL4Agugo7I8etCF8vVYDOT5J8gXupgGLiritkfALZD8HgNZADyM+NnvQBJrdeVoHxCYoQMCS2hySPf2AaZWT7PzVAeGidLcEeKlAgMBAAE="}}
				HwFastappObject.obtainOwnedPurchases(JSON.stringify(params));
	        }

	        HwFastappObject.onObtainOwnedPurchasesResult  = function onObtainOwnedPurchasesResult (str){
			    alert("onObtainOwnedPurchasesResult:"+JSON.stringify(str));
				var appData  = JSON.parse(str.data)
				inAppPurchaseData = appData.inAppPurchaseDataList
				var text = document.getElementById("text");
				alert("obtainOwnedPurchases inAppPurchaseData:"+JSON.stringify(inAppPurchaseData));
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onObtainOwnedPurchasesResult ="+JSON.stringify(str));
	        }
			
			function obtainProductInfo (){
			var priceType = document.getElementById("priceType")
			var productId = document.getElementById("productId")
		
			    var params = { productInfoReq: {"priceType": priceType.value,"productIds": productId.value,"applicationID": "101541297",}}
				HwFastappObject.obtainProductInfo(JSON.stringify(params));
	        }

	        HwFastappObject.onObtainProductInfoResult  = function onObtainProductInfoResult (str){
			    alert("onObtainProductInfoResult:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onObtainProductInfoResult ="+JSON.stringify(str));
	        }
			
			function createPurchaseIntent (){
			var priceType = document.getElementById("priceType")
			var productId = document.getElementById("productId")
			
			    var params = { purchaseIntentReq: {"applicationID": "101541297","productId": productId.value,"priceType": priceType.value,"developerPayload": "testPurchase",
				"publicKey":"MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAnLLFO6c8d1x6jdbZ8PkNtrLtRMiFaRqWZgEjC4Vj9QXnPCmDZoPO5A5TSwzlWjYL5ktbbDnZC6Vfp8VI8nTMm8DvbGsJ+1ihru31vG1gqvUgOaXESqBhdpMrKFEgNBV8zlalLpcCU6Gayd8QJCxXRPcUisHLTQFJHjTMOWmvOcKiSxt1VmG3dvfWVkoMeKyerZy4qHEWM/asJihPZATBQ7puMC/kOh6i8V2gv4w/74KWifpBr3J5RN+PK6E7yWUqIALFTnN5vOIif2HELvgt+S6uaGpRydhSwu1xtV7bPtXQY20ollYo4BUi+AvM16iBCa1+1Mdw0y6Y9gZAtpHRK1Pf+yea4aoY4y/bZ6EX21wucvbzxexDcBkGn0DVvNHKr3usmUmq/yfMMmDPqPujv3iDWKFENfL4Agugo7I8etCF8vVYDOT5J8gXupgGLiritkfALZD8HgNZADyM+NnvQBJrdeVoHxCYoQMCS2hySPf2AaZWT7PzVAeGidLcEeKlAgMBAAE=",}}
				HwFastappObject.createPurchaseIntent(JSON.stringify(params));
	        }

	        HwFastappObject.onCreatePurchaseIntentResult  = function onCreatePurchaseIntentResult (str){
			    alert("onCreatePurchaseIntentResult:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onCreatePurchaseIntentResult ="+JSON.stringify(str));
	        }
			
			function consumeOwnedPurchase (){
			alert("consumeOwnedPurchase:"+JSON.stringify(inAppPurchaseData));
			    var params = { consumeOwnedPurchaseReq: {"applicationID": "101541297","developerPayload":"testPurchase","purchaseToken":inAppPurchaseData[0].purchaseToken,
          "publicKey":"MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAnLLFO6c8d1x6jdbZ8PkNtrLtRMiFaRqWZgEjC4Vj9QXnPCmDZoPO5A5TSwzlWjYL5ktbbDnZC6Vfp8VI8nTMm8DvbGsJ+1ihru31vG1gqvUgOaXESqBhdpMrKFEgNBV8zlalLpcCU6Gayd8QJCxXRPcUisHLTQFJHjTMOWmvOcKiSxt1VmG3dvfWVkoMeKyerZy4qHEWM/asJihPZATBQ7puMC/kOh6i8V2gv4w/74KWifpBr3J5RN+PK6E7yWUqIALFTnN5vOIif2HELvgt+S6uaGpRydhSwu1xtV7bPtXQY20ollYo4BUi+AvM16iBCa1+1Mdw0y6Y9gZAtpHRK1Pf+yea4aoY4y/bZ6EX21wucvbzxexDcBkGn0DVvNHKr3usmUmq/yfMMmDPqPujv3iDWKFENfL4Agugo7I8etCF8vVYDOT5J8gXupgGLiritkfALZD8HgNZADyM+NnvQBJrdeVoHxCYoQMCS2hySPf2AaZWT7PzVAeGidLcEeKlAgMBAAE="}}
				HwFastappObject.consumeOwnedPurchase(JSON.stringify(params));
	        }

	        HwFastappObject.onConsumeOwnedPurchaseResult  = function onConsumeOwnedPurchaseResult (str){
			    alert("onConsumeOwnedPurchaseResult :"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onConsumeOwnedPurchaseResult ="+JSON.stringify(str));
	        }
			
			function obtainOwnedPurchaseRecord (){
			var priceType = document.getElementById("priceType")
			    var params = { ownedPurchasesRecordReq: {"applicationID": "101541297","priceType": priceType.value,
                 "publicKey":"MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAnLLFO6c8d1x6jdbZ8PkNtrLtRMiFaRqWZgEjC4Vj9QXnPCmDZoPO5A5TSwzlWjYL5ktbbDnZC6Vfp8VI8nTMm8DvbGsJ+1ihru31vG1gqvUgOaXESqBhdpMrKFEgNBV8zlalLpcCU6Gayd8QJCxXRPcUisHLTQFJHjTMOWmvOcKiSxt1VmG3dvfWVkoMeKyerZy4qHEWM/asJihPZATBQ7puMC/kOh6i8V2gv4w/74KWifpBr3J5RN+PK6E7yWUqIALFTnN5vOIif2HELvgt+S6uaGpRydhSwu1xtV7bPtXQY20ollYo4BUi+AvM16iBCa1+1Mdw0y6Y9gZAtpHRK1Pf+yea4aoY4y/bZ6EX21wucvbzxexDcBkGn0DVvNHKr3usmUmq/yfMMmDPqPujv3iDWKFENfL4Agugo7I8etCF8vVYDOT5J8gXupgGLiritkfALZD8HgNZADyM+NnvQBJrdeVoHxCYoQMCS2hySPf2AaZWT7PzVAeGidLcEeKlAgMBAAE="}}
				HwFastappObject.obtainOwnedPurchaseRecord(JSON.stringify(params));
	        }

	        HwFastappObject.onObtainOwnedPurchaseRecordResult  = function onObtainOwnedPurchaseRecordResult (str){
			    alert("onObtainOwnedPurchaseRecordResult:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onObtainOwnedPurchaseRecordResult ="+JSON.stringify(str));
	        }
			
			function startIapActivity (){
			    var params = { startIapActivityReq: {"applicationID": "101541297","type":2,}}
				HwFastappObject.startIapActivity(JSON.stringify(params));
	        }

	        HwFastappObject.onStartIapActivityResult  = function onStartIapActivityResult (str){
			    alert("startIapActivity:Result:"+JSON.stringify(str));
				var text = document.getElementById("text");
				//text.innerHTML = JSON.stringify(str);
				text.innerHTML = str;
			    console.log("yuli","onStartIapActivityResult ="+JSON.stringify(str));
	        }
			
	
    </script>
</head>
<body>
<p>支付H5demo</p>
<style>
#text{ border:1px solid #00F; width:200px;word-wrap:break-word} </style>


<p>IAP for Non-Managed Products(1060+)</p>
<input type="button" id="button3" value="obtain product details from Huawei PMS" onclick="getProductDetails()"/></br></br>
<input type="button" id="button2" value="product pay" onclick="productPay()"/></br></br>
<input type="button" id="button2" value="custom pay" onclick="pay()"/></br></br>
<input type="button" id="button3" value="query information about non-consumable product orders" onclick="getPurchaseInfo()"/></br></br>
<input type="button" id="button2" value="query order details" onclick="getOrderDetail()"/> </br></br>

<p>pay 1073</p>
<input type="button" id="button3" value=" check whether the currently signed-in ID is located in a country or region where HUAWEI IAP is available" onclick="isEnvReady()"/></br></br>
<input type="button" id="button2" value="Checks whether the HUAWEI ID meets the sandbox testing requirements" onclick="isSandboxActivated()"/></br></br>
<input type="button" id="button3" value="Queries information about all purchased products" onclick="obtainOwnedPurchases()"/></br></br>
<input type="button" id="button2" value="Obtains product details configured in AppGallery Connect" onclick="obtainProductInfo()"/></br></br>
<input type="button" id="button3" value="Creates orders for PMS products" onclick="createPurchaseIntent()"/></br></br>
<input type="button" id="button2" value="Consumes a consumable" onclick="consumeOwnedPurchase()"/> </br></br>
<input type="button" id="button2" value="Obtains the historical consumption information about a consumable or all subscription receipts of a subscription" onclick="obtainOwnedPurchaseRecord()"/> </br></br>

<input type="button" id="button2" value="Open the Huawei in-app payment page" onclick="startIapActivity()"/></br></br>
<div type="text" id="text">test</div>

<div style="margin-top: 20px;margin-left: 20px">
    <div id="javascript"></div>
</div>
</body>
</html>